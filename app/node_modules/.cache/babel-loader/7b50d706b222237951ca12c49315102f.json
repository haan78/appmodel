{"remainingRequest":"/app/node_modules/babel-loader/lib/index.js!/app/node_modules/eslint-loader/index.js??ref--13-0!/app/src/lib/SubutaiHttp.js","dependencies":[{"path":"/app/src/lib/SubutaiHttp.js","mtime":1632404764891},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1632907835816},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":1632907843228},{"path":"/app/node_modules/eslint-loader/index.js","mtime":1632907837067}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZXhwb3J0IGRlZmF1bHQgewogIGRlZmF1bHQ6IHsKICAgIGNoYXJzZXQ6ICJVVEYtOCIsCiAgICB1c2VEYXRhVHJhbnNmb3JtOiB0cnVlCiAgfSwKICBhY3RpdmVSZXF1ZXN0Q291bnQ6IDAsCiAgb25TdGFydDogZnVuY3Rpb24gKCkge30sCiAgb25TdG9wOiBmdW5jdGlvbiAoKSB7fSwKCiAgaXNMb2FkaW5nKCkgewogICAgcmV0dXJuIHRoaXMuYWN0aXZlUmVxdWVzdENvdW50ID4gMDsKICB9LAoKICB2YWxpZGF0ZShyZXNwb25zZSkgewogICAgaWYgKHR5cGVvZiByZXNwb25zZSA9PT0gIm9iamVjdCIgJiYgdHlwZW9mIHJlc3BvbnNlLnN1Y2Nlc3MgPT09ICJib29sZWFuIiAmJiB0eXBlb2YgcmVzcG9uc2UuZGF0YSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwKCiAgdXAoKSB7CiAgICBpZiAodGhpcy5hY3RpdmVSZXF1ZXN0Q291bnQgPT09IDApIHsKICAgICAgaWYgKHR5cGVvZiB0aGlzLm9uU3RhcnQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB0aGlzLm9uU3RhcnQoKTsKICAgICAgfQogICAgfQoKICAgIHRoaXMuYWN0aXZlUmVxdWVzdENvdW50ICs9IDE7CiAgfSwKCiAgZG93bigpIHsKICAgIGlmICh0aGlzLmFjdGl2ZVJlcXVlc3RDb3VudCA+IDApIHsKICAgICAgdGhpcy5hY3RpdmVSZXF1ZXN0Q291bnQgLT0gMTsKICAgIH0KCiAgICBpZiAodGhpcy5hY3RpdmVSZXF1ZXN0Q291bnQgPT09IDApIHsKICAgICAgaWYgKHR5cGVvZiB0aGlzLm9uU3RvcCA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIHRoaXMub25TdG9wKCk7CiAgICAgIH0KICAgIH0KICB9LAoKICBkYXRhVHJhbnNmb3JtKGRhdGEsIGxldmVsKSB7CiAgICB2YXIgbCA9IGxldmVsID8gbGV2ZWwgOiAwOwoKICAgIGlmIChkYXRhID09PSBudWxsKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfSBlbHNlIGlmICh0eXBlb2YgZGF0YSA9PT0gIm9iamVjdCIpIHsKICAgICAgLy9vYmplY3QKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZGF0YSkpIHsKICAgICAgICB2YXIgYXJyID0gW107CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgICAgYXJyLnB1c2godGhpcy5kYXRhVHJhbnNmb3JtKGRhdGFbaV0pLCBsICsgMSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gYXJyOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBvYmogPSB7fTsKCiAgICAgICAgZm9yICh2YXIgayBpbiBkYXRhKSB7CiAgICAgICAgICBvYmpba10gPSB0aGlzLmRhdGFUcmFuc2Zvcm0oZGF0YVtrXSwgbCArIDEpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG9iajsKICAgICAgfQogICAgfSBlbHNlIGlmICh0eXBlb2YgZGF0YSA9PT0gImZ1bmN0aW9uIikgewogICAgICByZXR1cm4gdGhpcy5kYXRhVHJhbnNmb3JtKGRhdGEobCksIGwgKyAxKTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIGRhdGEgPT09ICJzdHJpbmciKSB7CiAgICAgIHZhciBzdHIgPSBkYXRhLnRyaW0oKTsKCiAgICAgIGlmIChzdHIgPT09ICIiKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgfQogICAgfSBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgRGF0ZSkgewogICAgICByZXR1cm4gZGF0YS50b0lTT1N0cmluZygpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGRhdGE7CiAgICB9CiAgfSwKCiAgcmVxdWVzdCh1cmwsIGRhdGEsIHNldHRpbmdzKSB7CiAgICBsZXQgc2VsZiA9IHRoaXM7CiAgICBsZXQgc2V0dCA9IHNlbGYuZGVmYXVsdDsKCiAgICBpZiAodHlwZW9mIHNldHRpbmdzID09PSAib2JqZWN0IiAmJiBzZXR0aW5ncyAhPT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrIGluIHNlbGYuZGVmYXVsdCkgewogICAgICAgIGlmICh0eXBlb2Ygc2V0dGluZ3Nba10gIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICBzZXR0W2tdID0gc2V0dGluZ3Nba107CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgdmFyIEhUVFAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKCiAgICAgIEhUVFAub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4gewogICAgICAgIGlmIChIVFRQLnJlYWR5U3RhdGUgPT09IDQpIHsKICAgICAgICAgIGlmIChIVFRQLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgIHZhciByZXNwb25zZTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgcmVzcG9uc2UgPSBKU09OLnBhcnNlKEhUVFAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgICByZWplY3QoZXgsIEhUVFAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChzZWxmLnZhbGlkYXRlKHJlc3BvbnNlKSkgewogICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB2YXIgbXNnID0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlID8gcmVzcG9uc2UuZGF0YS5tZXNzYWdlIDogIlVuZGVmaW5lZCBlcnJvciBtZXNzYWdlIjsKICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IobXNnKSwgcmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoIlJlc3BvbnNlIGlzIHVuZXhwZWN0ZWQiKSwgcmVzcG9uc2UpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QobmV3IEVycm9yKEhUVFAuc3RhdHVzVGV4dCksIEhUVFAuc3RhdHVzKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzZWxmLmRvd24oKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBIVFRQLm9wZW4oIlBPU1QiLCB1cmwsIHRydWUpOwogICAgICBIVFRQLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtdHlwZSIsICJhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9IiArIHNldHQuY2hhcnNldCk7CiAgICAgIHZhciBkOwoKICAgICAgaWYgKHNldHQudXNlRGF0YVRyYW5zZm9ybSkgewogICAgICAgIGQgPSBzZWxmLmRhdGFUcmFuc2Zvcm0oZGF0YSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZCA9IGRhdGE7CiAgICAgIH0KCiAgICAgIHNlbGYudXAoKTsKICAgICAgSFRUUC5zZW5kKEpTT04uc3RyaW5naWZ5KGQpKTsKICAgIH0pOwogIH0KCn07"},{"version":3,"sources":["/app/src/lib/SubutaiHttp.js"],"names":["default","charset","useDataTransform","activeRequestCount","onStart","onStop","isLoading","validate","response","success","data","up","down","dataTransform","level","l","Array","isArray","arr","i","length","push","obj","k","str","trim","Date","toISOString","request","url","settings","self","sett","Promise","resolve","reject","HTTP","XMLHttpRequest","onreadystatechange","readyState","status","JSON","parse","responseText","ex","msg","message","Error","statusText","open","setRequestHeader","d","send","stringify"],"mappings":"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","sourcesContent":["export default {\r\n    default:{\r\n        charset: \"UTF-8\",\r\n        useDataTransform:true\r\n    },\r\n    activeRequestCount:0,\r\n\r\n    onStart : function() {},\r\n    onStop : function() {},\r\n\r\n    isLoading() {\r\n        return this.activeRequestCount > 0;\r\n    },\r\n\r\n    validate(response) {\r\n        if ( typeof response === \"object\" && typeof response.success === \"boolean\" && typeof response.data !== \"undefined\" ) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    up() {       \r\n        if (this.activeRequestCount === 0) {\r\n            if (  typeof this.onStart ===  \"function\") {\r\n                this.onStart();\r\n            }\r\n        } \r\n        this.activeRequestCount += 1;       \r\n    },\r\n\r\n    down() {\r\n        if ( this.activeRequestCount > 0 ) {\r\n            this.activeRequestCount -= 1;       \r\n        } \r\n        if ( this.activeRequestCount === 0 ) {\r\n            if (  typeof this.onStop ===  \"function\") {\r\n                this.onStop();\r\n            }\r\n        }\r\n    },\r\n\r\n    dataTransform(data,level) {\r\n        var l = ( level ? level : 0 );\r\n        if ( data === null ) {\r\n            return null;\r\n        } else if ( typeof data === \"object\") { //object\r\n            if (Array.isArray( data )) {\r\n                var arr = [];\r\n                for(var i=0; i<data.length; i++) {\r\n                    arr.push( this.dataTransform(data[i]),l+1 );\r\n                }\r\n                return arr;\r\n            } else {\r\n                var obj = {};\r\n                for( var k in data ) {\r\n                    obj[k] = this.dataTransform( data[k],l+1 );\r\n                }\r\n                return obj;\r\n            }\r\n        } else if (typeof data === \"function\") {\r\n            return this.dataTransform( data(l),l+1 );\r\n        } else if (typeof data === \"string\" ) {\r\n            var str = data.trim();\r\n            if ( str === \"\" ) {\r\n                return null;\r\n            } else {\r\n                return str;\r\n            }\r\n        } else if (data instanceof Date) {\r\n            return data.toISOString();\r\n        } else {\r\n            return data;\r\n        }\r\n    },\r\n    request(url,data,settings) {\r\n        let self = this;\r\n\r\n        let sett = self.default;\r\n        if ( typeof settings === \"object\" && settings!==null ) {\r\n            for(var k in self.default) {\r\n                if ( typeof settings[k] !== \"undefined\" ) {\r\n                    sett[k] = settings[k];\r\n                }\r\n            }\r\n        }\r\n        return new Promise( (resolve,reject)=>{\r\n            var HTTP = new XMLHttpRequest();\r\n            HTTP.onreadystatechange = () =>{\r\n                if (HTTP.readyState === 4) {\r\n                    if (HTTP.status === 200) {\r\n                        var response;\r\n                        try {\r\n                            response = JSON.parse(HTTP.responseText);\r\n                        } catch (ex) {\r\n                            reject(ex,HTTP.responseText);\r\n                            return;\r\n                        }\r\n                        if ( self.validate(response) ) {\r\n                            if ( response.success ) {\r\n                                resolve(response.data);\r\n                            } else {\r\n                                var msg = (response.data.message ? response.data.message : \"Undefined error message\" );\r\n                                reject(new Error(msg),response.data);\r\n                            }\r\n                        } else {\r\n                            reject(new Error(\"Response is unexpected\"),response);\r\n                        }                        \r\n                    } else {\r\n                        reject( new Error( HTTP.statusText ),HTTP.status );\r\n                    }\r\n                    self.down();\r\n                }\r\n            }\r\n\r\n            HTTP.open(\"POST\", url, true);\r\n            HTTP.setRequestHeader(\"Content-type\", \"application/json;charset=\" + sett.charset);\r\n            var d; \r\n            if (sett.useDataTransform) {\r\n                d = self.dataTransform(data);\r\n            } else {\r\n                d = data;\r\n            }\r\n            self.up();\r\n            HTTP.send(JSON.stringify(d));\r\n        } );\r\n    }\r\n}"]}]}